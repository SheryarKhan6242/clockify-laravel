$(function() {
    //PIE CHART
    c3.generate({
        bindto: "#campaign-v2",
        data: {
            columns: [
                ["Present", 10],
                ["Absent", 15]
            ],
            type: "donut",
            tooltip: { show: !0 }
        },
        donut: { label: { show: !1 }, width: 18 },
        legend: { hide: !0 },
        color: { pattern: ["#01caf1", "#ff4f70"] }
    }), d3.select("#campaign-v2 .c3-chart-arcs-title").style("font-family", "Rubik");


    //Sick leaves Pie chart
    c3.generate({
        bindto: "#sick-chart",
        data: {
            columns: [
                ["Present", 10],
                ["Absent", 15]
            ],
            type: "donut",
            tooltip: { show: !0 }
        },
        donut: { label: { show: !1 }, width: 18 },
        legend: { hide: !0 },
        color: { pattern: ["#01caf1", "#ff4f70"] }
    }), d3.select("#sick-chart .c3-chart-arcs-title").style("font-family", "Rubik");

    //Medical Reimbursement
    c3.generate({
        bindto: "#medical-chart",
        data: {
            columns: [
                ["Present", 10],
                ["Absent", 15]
            ],
            type: "donut",
            tooltip: { show: !0 }
        },
        donut: { label: { show: !1 }, width: 18 },
        legend: { hide: !0 },
        color: { pattern: ["#01caf1", "#ff4f70"] }
    }), d3.select("#medical-chart .c3-chart-arcs-title").style("font-family", "Rubik");

    //BAR CHART
    // var e = { axisX: { showGrid: !1 }, seriesBarDistance: 1, chartPadding: { top: 15, right: 15, bottom: 5, left: 0 }, plugins: [Chartist.plugins.tooltip()], width: "100%" },
    //     t = (new Chartist.Bar(".net-income", {
    //         labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun"],
    //         series: [
    //             [5, 4, 3, 7, 5, 10]
    //         ]
    //     }, e, [
    //         ["screen and (max-width: 640px)", { seriesBarDistance: 5, axisX: { labelInterpolationFnc: function(e) { return e[0] } } }]
    //     ]), jQuery("#visitbylocate").vectorMap({
    //         map: "world_mill_en",
    //         backgroundColor: "transparent",
    //         borderColor: "#000",
    //         borderOpacity: 0,
    //         borderWidth: 20,
    //         zoomOnScroll: !1,
    //         color: "#d5dce5",
    //         regionStyle: { initial: { fill: "#d5dce5", "stroke-width": 1, stroke: "rgba(255, 255, 255, 0.5)" } },
    //         enableZoom: !0,
    //         hoverColor: "#bdc9d7",
    //         hoverOpacity: null,
    //         normalizeFunction: "linear",
    //         scaleColors: ["#d5dce5", "#d5dce5"],
    //         selectedColor: "#bdc9d7",
    //         selectedRegions: [],
    //         showTooltip: !0,
    //         onRegionClick: function(e, t, o) {
    //             o = 'You clicked "' + o + '" which has the code: ' + t.toUpperCase();
    //             alert(o)
    //         }
    //     }), new Chartist.Line(".stats", {
    //         labels: ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"],
    //         series: [
    //             [11, 10, 15, 21, 14, 23, 12]
    //         ]
    //     }, { axisY: { onlyInteger: !0, scaleMinSpace: 40, offset: 20, labelInterpolationFnc: function(e) { return +e + "k" } } }));
    // t.on("draw", function(e) { "area" === e.type && e.element.attr({ x1: e.x1 + .001 }) }), t.on("created", function(e) { e.svg.elem("defs").elem("linearGradient", { id: "gradient", x1: 0, y1: 1, x2: 0, y2: 0 }).elem("stop", { offset: 0, "stop-color": "rgba(255, 255, 255, 1)" }).parent().elem("stop", { offset: 1, "stop-color": "rgba(80, 153, 255, 1)" }) }), $(window).on("resize", function() { t.update() })

    // new Chartist.Bar('.net-income', {
    //     labels: ['XS', 'S', 'M', 'L', 'XL', 'XXL', 'XXXL'],
    //     series: [20, 60, 120, 200, 180, 20, 10]
    // }, {
    //     distributeSeries: true
    // });
    // Make an AJAX request to fetch the employee max working hours and show the chart
    var query = $('#emp-work-hours').val();
    $.ajax({
        url: 'ajax/get-emp-work-hours?filter=' + query + ' ',
        method: 'GET',
        success: function(response) {
            // Call the function to update the chart with the retrieved data
            updateChart(response);
        },
        error: function(error) {
            console.log(error);
        }
    });

    // Function to update the chart with the retrieved data
    function updateChart(data) {
        // Prepare the chart data(x-axis and y-axis)
        var chartData = {
            labels: data.labels,
            series: [data.series]
        };

        // Calculate the maximum value for y-axes
        var maxHours = Math.ceil(data.maxHours / 10) * 10;

        // Set the chart options(Bipolar chart eg from charlistjs documentation)
        var options = {
            high: maxHours,
            axisY: {
                labelInterpolationFnc: function(value) {
                    return value + 'h';
                }
            }
        };
        // Create the chart
        var chart = new Chartist.Bar('.emp-max-hours', chartData, options);
        // Find the maximum value and its index in the data.series array
        var maxBarValue = Math.max(...data.series);
        var maxBarIndex = data.series.indexOf(maxBarValue);

        // Change the stroke color of the bars
        chart.on('draw', function(data) {
            if (data.type === 'bar') {
                if (data.index === maxBarIndex) {
                    data.element.attr({
                        style: 'stroke: #27B9C2; width: 24px;' //For max Working hours change color code
                    });
                } else {
                    data.element.attr({
                        style: 'stroke: #3E6E75; width: 24px;' // For remaining Working hours bar keep same color code
                    });
                }
            }
        });
    }


    //Onchange Employee working hours
    $('#emp-work-hours').on('change', function() {
        // alert("changed");
        var query = $('#emp-work-hours').val();
        //Call monthly Ajax
        $.ajax({
            url: 'ajax/get-emp-work-hours?filter=' + query + ' ',
            method: 'GET',
            success: function(response) {
                // Call the function to update the chart with the retrieved data
                updateChart(response);
            },
            error: function(error) {
                console.log(error);
            }
        });
    });

});